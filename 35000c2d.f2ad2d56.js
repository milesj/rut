(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{79:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return i})),t.d(n,"metadata",(function(){return c})),t.d(n,"toc",(function(){return s})),t.d(n,"default",(function(){return m}));var o=t(3),r=t(7),a=(t(0),t(90)),i={title:"Caveats"},c={unversionedId:"caveats",id:"caveats",isDocsHomePage:!1,title:"Caveats",description:"Do not find a React.memo() component",source:"@site/docs/caveats.md",slug:"/caveats",permalink:"/docs/caveats",editUrl:"https://github.com/milesj/rut/edit/master/website/docs/caveats.md",version:"current",sidebar:"docs",previous:{title:"Predicates",permalink:"/docs/predicates"}},s=[{value:"Do not find a <code>React.memo()</code> component",id:"do-not-find-a-reactmemo-component",children:[]},{value:"String interpolation must match for <code>toContainNode()</code>",id:"string-interpolation-must-match-for-tocontainnode",children:[]}],p={toc:s};function m(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(a.b)("wrapper",Object(o.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"do-not-find-a-reactmemo-component"},"Do not find a ",Object(a.b)("inlineCode",{parentName:"h2"},"React.memo()")," component"),Object(a.b)("p",null,"When using ",Object(a.b)("a",{parentName:"p",href:"/docs/api/element#find"},Object(a.b)("inlineCode",{parentName:"a"},"Element#find()"))," (and variants) or\n",Object(a.b)("a",{parentName:"p",href:"/docs/api/element#query"},Object(a.b)("inlineCode",{parentName:"a"},"Element#query()")),", you may run into an issue where the component reference\nyou're trying to find is not found. This is usually caused by component references that are wrapped\nin ",Object(a.b)("inlineCode",{parentName:"p"},"React.memo()"),", as memo components do not appear in the reconciled tree, and as such, cannot be\nfound!"),Object(a.b)("p",null,"To work around this, the component that is being wrapped by ",Object(a.b)("inlineCode",{parentName:"p"},"React.memo()")," is the one that should be\nused, ",Object(a.b)("em",{parentName:"p"},"not")," the memoized component. A typical pattern in HOCs is to provide the wrapped component as\na static property, like ",Object(a.b)("inlineCode",{parentName:"p"},"Foo.WrappedComponent"),", which can also be used."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-tsx"},"import React from 'react';\nimport { render } from 'rut-dom';\n\nfunction BaseComp() {\n  return <div />;\n}\n\nconst MemoComp = React.memo(BaseComp);\n\nconst { root } = render(\n  <App>\n    <MemoComp />\n  </App>,\n);\n\n// Wrong\nroot.findOne(MemoComp);\n\n// Correct\nroot.findOne(BaseComp);\n")),Object(a.b)("h2",{id:"string-interpolation-must-match-for-tocontainnode"},"String interpolation must match for ",Object(a.b)("inlineCode",{parentName:"h2"},"toContainNode()")),Object(a.b)("p",null,"When an element uses interpolation within its children, and you're attempting to find a node using\nan element (and not a string), the expectation must also use interpolation. For example, take this\ncomponent that renders a user's name, and some assertions checking for a node."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-tsx"},'function User({ firstName, lastName }: { firstName: string; lastName: string }) {\n  return (\n    <h1>\n      {user.firstName} {user.lastName}\n    </h1>\n  );\n}\n\nconst { root } = render(<User firstName="Bruce" lastName="Wayne" />);\n\n// Works\nexpect(root).toContainNode(\'Bruce Wayne\');\n\n// Does not work???\nexpect(root).toContainNode(<h1>Bruce Wayne</h1>);\n')),Object(a.b)("p",null,"The reason the latter doesn't work is because of how React's internals work. When interpolation is\nused, the ",Object(a.b)("inlineCode",{parentName:"p"},"children")," prop becomes an array, resulting in the rendered children to be\n",Object(a.b)("inlineCode",{parentName:"p"},"['Bruce', ' ', 'Wayne']"),", while the expectation's children is simply ",Object(a.b)("inlineCode",{parentName:"p"},"'Bruce Wayne'"),". These do not\nmatch! To fix this, the expectation must also use matching interpolations."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-tsx"},"// Works\nexpect(root).toContainNode(\n  <h1>\n    {'Bruce'} {'Wayne'}\n  </h1>,\n);\n")),Object(a.b)("p",null,"When in doubt, just use strings!"))}m.isMDXComponent=!0},90:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return b}));var o=t(0),r=t.n(o);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var p=r.a.createContext({}),m=function(e){var n=r.a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},u=function(e){var n=m(e.components);return r.a.createElement(p.Provider,{value:n},e.children)},l={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},d=r.a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=m(t),d=o,b=u["".concat(i,".").concat(d)]||u[d]||l[d]||a;return t?r.a.createElement(b,c(c({ref:n},p),{},{components:t})):r.a.createElement(b,c({ref:n},p))}));function b(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=d;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c.mdxType="string"==typeof e?e:o,i[1]=c;for(var p=2;p<a;p++)i[p]=t[p];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,t)}d.displayName="MDXCreateElement"}}]);